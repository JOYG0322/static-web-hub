<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>JiBaJiBa v4.3 优化版（更新）</title>
    <link rel="icon" type="image/svg+xml" id="favicon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path fill='%23FFF' d='M96.7 270.3C49 360.7 10 435 10 435.3c0 .4 16.5.6 36.6.5l36.6-.3 50-94.5c27.5-52 51.5-97.4 53.4-101l3.5-6.5-.4 89.5-.4 89.5 15.8 11.8 15.8 11.7h192.4l15.8-11.7 15.8-11.8.1-147c0-88.9-.4-146.5-.9-146-.5.6-15.6 26.2-33.6 57l-32.6 55.9.1 58.8V350H257V106h-73.5z'/><path fill='maroon' d='M370.3 107.2c-.5.7-24.2 41.4-52.7 90.5l-51.7 89.1-.2 26.6-.2 26.6 21.7-.2 21.7-.3 67.4-116 67.4-116-15.6-.6c-29.6-1.2-56.8-1-57.8.3'/></svg>">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="css/jiBaJiBa.css?v=4.3.9">
</head>
<body>
    <div class="container">
    </div>

    <div class="main_">
        <div class="videoWrapper">
            <div class="videoContainer" id="videoContainer1" aria-live="polite">
                <video id="remoteVideo" autoplay playsinline muted controls></video>
                <div class="status-row">
                    <div id="status" class="status">未连接</div>
                    <div id="qualityIndicator" class="quality-indicator">
                        <span class="quality-dot"></span>
                        <span class="quality-text">--</span>
                    </div>
                    <span class="status-divider">|</span>
                    <span id="audioStatus" class="audio-stat">音频: --</span>
                    <span id="audioJitter" class="audio-stat">抖动: --</span>
                    <span id="audioSampleRate" class="audio-stat">采样率: --</span>
                    <div class="audio-visual-inline">
                        <div id="audioBar" class="audio-bar" style="display: none;">
                            <div class="audio-bar-fill" id="audioBarFill"></div>
                        </div>
                        <div id="audioWave" class="audio-wave" style="display: none;">
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                        </div>
                    </div>
                </div>
                <div class="controls" role="toolbar">
                    <button class="button_l" id="refreshBtn">刷新</button>
                    <button class="button_l" id="disconnectBtn">断开</button>
                    <button class="button_l" id="fullscreenBtn">网页全屏</button>
                    <button class="button_l" id="splitScreenBtn">分屏</button>
                </div>
            </div>
            <div class="videoContainer videoContainer2" id="videoContainer2" style="display: none;" aria-live="polite">
                <video id="remoteVideo2" autoplay playsinline muted controls></video>
                <div class="status-row">
                    <div id="status2" class="status">未连接</div>
                    <div id="qualityIndicator2" class="quality-indicator">
                        <span class="quality-dot"></span>
                        <span class="quality-text">--</span>
                    </div>
                    <span class="status-divider">|</span>
                    <span id="audioStatus2" class="audio-stat">音频: --</span>
                    <span id="audioJitter2" class="audio-stat">抖动: --</span>
                    <span id="audioSampleRate2" class="audio-stat">采样率: --</span>
                    <div class="audio-visual-inline">
                        <div id="audioBar2" class="audio-bar" style="display: none;">
                            <div class="audio-bar-fill" id="audioBarFill2"></div>
                        </div>
                        <div id="audioWave2" class="audio-wave" style="display: none;">
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                        </div>
                    </div>
                </div>
                <div class="controls" role="toolbar">
                    <button class="button_l" id="refreshBtn2">刷新</button>
                    <button class="button_l" id="disconnectBtn2">断开</button>
                    <button class="button_l" id="closeSplitBtn">关闭分屏</button>
                </div>
            </div>
        </div>

        <div class="buttons" id="channelList">
            <div class="section-title-row">
                <div class="section-title">预设频道</div>
                <div class="target-selector">
                    <button class="target-btn active" data-target="main" title="主视频">主</button>
                    <button class="target-btn" data-target="split" title="分屏视频">分</button>
                </div>
                <button class="refresh-status-btn" id="refreshPresetBtn" title="刷新频道状态">刷新</button>
            </div>
            <div id="presetContainer" aria-label="预设频道"></div>
            <div class="search_">
                <input id="roomInput" type="text" placeholder="输入房间号" class="text_enter" aria-label="房间号">
                <button class="button_s" id="connectBtn">连接</button>
            </div>
            <div class="section-title-row">
                <div class="section-title">历史记录</div>
                <button class="refresh-status-btn" id="refreshHistoryBtn" title="刷新历史状态">刷新</button>
                <button class="clear-history-btn" id="clearHistoryBtn">全部删除</button>
            </div>
            <div id="historyContainer" aria-label="历史记录"></div>
            <div class="theme-switcher-bottom">
                <button class="settings-btn" id="settingsBtn" title="设置">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                </button>
            </div>
        </div>
    </div>

    <div class="settings-panel" id="settingsPanel">
        <div class="settings-panel-header">
            <span>设置</span>
            <button class="settings-panel-close" id="settingsPanelClose">&times;</button>
        </div>
        <div class="settings-panel-content">
            <div class="settings-section">
                <div class="settings-section-title">主题设置</div>
                <div class="theme-segment">
                    <div class="theme-segment-indicator" id="themeSegmentIndicator"></div>
                    <div class="theme-segment-item" data-theme="dark">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.2764 9.52325C12.5607 9.97755 11.7177 10.242 10.7812 10.242C8.11386 10.2419 5.95042 8.07997 5.9502 5.4129C5.9502 4.48129 6.21453 3.61072 6.67188 2.87286C4.30332 3.4658 2.54992 5.60846 2.5498 8.16094C2.5498 11.1712 4.99103 13.6102 8 13.6102C10.5383 13.6102 12.6709 11.8725 13.2764 9.52325ZM7.05078 5.4129C7.051 7.47225 8.72116 9.14231 10.7812 9.14239C11.9248 9.14239 12.887 8.63398 13.5781 7.8084C13.7266 7.63107 13.9701 7.56548 14.1875 7.64434C14.4049 7.7233 14.5497 7.9297 14.5498 8.16094C14.5498 11.7766 11.6161 14.7098 8 14.7098C4.38402 14.7098 1.4502 11.7792 1.4502 8.16094C1.45033 4.54323 4.3812 1.61016 8 1.61016C8.23027 1.61016 8.43585 1.75353 8.51562 1.96954C8.59536 2.18555 8.53241 2.4283 8.35742 2.57793C7.55573 3.26311 7.05078 4.27877 7.05078 5.4129Z"/></svg>
                        <span>黑暗</span>
                    </div>
                    <div class="theme-segment-item" data-theme="light">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.3496 8C11.3496 6.14985 9.85015 4.65039 8 4.65039C6.14985 4.65039 4.65039 6.14985 4.65039 8C4.65039 9.85015 6.14985 11.3496 8 11.3496C9.85015 11.3496 11.3496 9.85015 11.3496 8ZM12.6504 8C12.6504 10.5681 10.5681 12.6504 8 12.6504C5.43188 12.6504 3.34961 10.5681 3.34961 8C3.34961 5.43188 5.43188 3.34961 8 3.34961C10.5681 3.34961 12.6504 5.43188 12.6504 8Z"/><path d="M8.65039 0.5V2.5H7.34961V0.5H8.65039Z"/><path d="M8.65039 13.5V15.5H7.34961V13.5H8.65039Z"/><path d="M3.15808 2.24035L4.57229 3.65456L3.6525 4.57435L2.23829 3.16014L3.15808 2.24035Z"/><path d="M12.3505 11.4327L13.7647 12.8469L12.8449 13.7667L11.4307 12.3525L12.3505 11.4327Z"/><path d="M2.24537 12.8469L3.65958 11.4327L4.57937 12.3525L3.16516 13.7667L2.24537 12.8469Z"/><path d="M11.4377 3.65455L12.852 2.24033L13.7718 3.16012L12.3575 4.57434L11.4377 3.65455Z"/><path d="M0.5 7.35461H2.5V8.6554H0.5L0.5 7.35461Z"/><path d="M13.5 7.35461H15.5V8.6554H13.5V7.35461Z"/></svg>
                        <span>白天</span>
                    </div>
                    <div class="theme-segment-item" data-theme="auto">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.1665 13.5811V14.7803H3.66651V13.5811H12.1665Z"/><path d="M13.4453 7.02379C13.4453 6.04702 13.4452 5.3616 13.3887 4.83434C13.3333 4.31828 13.2302 4.02378 13.0723 3.80309C12.9446 3.62475 12.7877 3.46883 12.6094 3.34117C12.3887 3.18328 12.0942 3.08007 11.5781 3.02477C11.0508 2.96829 10.3655 2.96715 9.38867 2.96715H6.61035C5.63359 2.96715 4.94816 2.96827 4.4209 3.02477C3.90486 3.0801 3.61034 3.18321 3.38965 3.34117C3.21143 3.46878 3.05534 3.62487 2.92774 3.80309C2.76977 4.02377 2.66667 4.3183 2.61133 4.83434C2.55483 5.3616 2.55371 6.04702 2.55371 7.02379C2.55371 8.0006 2.55485 8.68596 2.61133 9.21324C2.66663 9.72936 2.76983 10.0238 2.92774 10.2445C3.0554 10.4228 3.21131 10.5797 3.38965 10.7074C3.61034 10.8654 3.90484 10.9685 4.4209 11.0238C4.94816 11.0803 5.63359 11.0804 6.61035 11.0804H9.38867C10.3654 11.0804 11.0508 11.0803 11.5781 11.0238C12.0941 10.9685 12.3887 10.8652 12.6094 10.7074C12.7877 10.5797 12.9446 10.4229 13.0723 10.2445C13.2301 10.0238 13.3334 9.72927 13.3887 9.21324C13.4452 8.68596 13.4453 8.00058 13.4453 7.02379ZM14.6455 7.02379C14.6455 7.97428 14.646 8.73509 14.5811 9.34117C14.5149 9.95828 14.3756 10.4858 14.0479 10.9437C13.8436 11.229 13.5938 11.4788 13.3086 11.683C12.8507 12.0108 12.3232 12.15 11.7061 12.2162C11.1 12.2811 10.3391 12.2806 9.38867 12.2806H6.61035C5.66018 12.2806 4.89991 12.2811 4.29395 12.2162C3.67684 12.15 3.14935 12.0108 2.69141 11.683C2.40613 11.4788 2.15639 11.229 1.95215 10.9437C1.62436 10.4858 1.4841 9.95828 1.41797 9.34117C1.35305 8.73511 1.35449 7.97424 1.35449 7.02379C1.35449 6.07366 1.35308 5.31333 1.41797 4.70738C1.4841 4.09028 1.62436 3.56279 1.95215 3.10485C2.15638 2.81956 2.40613 2.56982 2.69141 2.36559C3.14935 2.03779 3.67684 1.89753 4.29395 1.83141C4.8999 1.76652 5.66022 1.76793 6.61035 1.76793H9.38867C10.3391 1.76793 11.1 1.76649 11.7061 1.83141C12.3232 1.89753 12.8507 2.03779 13.3086 2.36559C13.5939 2.56982 13.8436 2.81957 14.0479 3.10485C14.3756 3.56279 14.5149 4.09028 14.5811 4.70738C14.646 5.31333 14.6455 6.07366 14.6455 7.02379Z"/></svg>
                        <span>自动</span>
                    </div>
                </div>
            </div>
            <div class="settings-section">
                <div class="settings-section-title">音频可视化</div>
                <div class="audio-visual-segment">
                    <div class="audio-visual-segment-indicator" id="audioVisualSegmentIndicator"></div>
                    <div class="audio-visual-segment-item" data-visual="none">
                        <span>无</span>
                    </div>
                    <div class="audio-visual-segment-item" data-visual="bar">
                        <svg viewBox="0 0 16 16" fill="currentColor"><rect x="1" y="8" width="3" height="6" rx="1"/><rect x="6" y="4" width="3" height="10" rx="1"/><rect x="11" y="2" width="3" height="12" rx="1"/></svg>
                        <span>条形</span>
                    </div>
                    <div class="audio-visual-segment-item" data-visual="wave">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1 8h1v2H1zM3 6h1v4H3zM5 4h1v8H5zM7 5h1v6H7zM9 3h1v10H9zM11 4h1v8h-1zM13 6h1v4h-1zM15 7h1v2h-1z"/></svg>
                        <span>波形</span>
                    </div>
                </div>
            </div>
            <div class="settings-section">
                <div class="settings-section-title">服务器设置</div>
                <div class="settings-row">
                    <label class="settings-label">服务器地址</label>
                    <select class="settings-select" id="settingsServerSelect">
                        <option value="10.126.126.15">10.126.126.15</option>
                    </select>
                </div>
                <div class="settings-row">
                    <label class="settings-label">连接前检测在线状态</label>
                    <label class="settings-switch">
                        <input type="checkbox" id="settingsCheckOnline" checked>
                        <span class="settings-slider"></span>
                    </label>
                </div>
            </div>
            <div class="settings-section">
                <div class="settings-section-title">启动设置</div>
                <div class="settings-row">
                    <label class="settings-label">记住打开的频道</label>
                    <label class="settings-switch">
                        <input type="checkbox" id="settingsRememberChannel">
                        <span class="settings-slider"></span>
                    </label>
                </div>
                <div class="settings-row">
                    <label class="settings-label">启动时自动开启</label>
                    <select class="settings-select" id="settingsAutoChannel">
                        <option value="">无</option>
                        <option value="JOYG">JOYG</option>
                        <option value="CMHH">CMHH</option>
                        <option value="PL">Pure1ove</option>
                        <option value="LJY">DJ_Hero</option>
                        <option value="AAA">REDguard</option>
                    </select>
                </div>
            </div>
            <div class="settings-section">
                <div class="settings-section-title">自动重连配置</div>
                <div class="settings-row">
                    <label class="settings-label">最大重连次数</label>
                    <input type="number" class="settings-input" id="settingsMaxAttempts" min="1" max="20" value="5">
                    <span class="settings-hint">次</span>
                </div>
                <div class="settings-row">
                    <label class="settings-label">初始重连延迟</label>
                    <input type="number" class="settings-input" id="settingsReconnectDelay" min="500" max="10000" step="500" value="1000">
                    <span class="settings-hint">毫秒</span>
                </div>
                <div class="settings-row">
                    <label class="settings-label">最大重连延迟</label>
                    <input type="number" class="settings-input" id="settingsMaxDelay" min="5000" max="120000" step="5000" value="30000">
                    <span class="settings-hint">毫秒</span>
                </div>
            </div>
        </div>
        <div class="settings-footer">
            <svg class="settings-footer-logo" viewBox="0 0 512 512"><path fill="currentColor" d="M96.7 270.3C49 360.7 10 435 10 435.3c0 .4 16.5.6 36.6.5l36.6-.3 50-94.5c27.5-52 51.5-97.4 53.4-101l3.5-6.5-.4 89.5-.4 89.5 15.8 11.8 15.8 11.7h192.4l15.8-11.7 15.8-11.8.1-147c0-88.9-.4-146.5-.9-146-.5.6-15.6 26.2-33.6 57l-32.6 55.9.1 58.8V350H257V106h-73.5z"/><path fill="maroon" d="M370.3 107.2c-.5.7-24.2 41.4-52.7 90.5l-51.7 89.1-.2 26.6-.2 26.6 21.7-.2 21.7-.3 67.4-116 67.4-116-15.6-.6c-29.6-1.2-56.8-1-57.8.3"/></svg>
            <span class="settings-footer-text">JiBaJiBa v4.3</span>
            <a href="javascript:void(0)" class="settings-footer-link" id="aboutLink">关于JiBaJiBa播放器</a>
        </div>
    </div>
    <div class="settings-panel-overlay" id="settingsPanelOverlay"></div>
    
    <div class="about-modal" id="aboutModal">
        <div class="about-modal-content">
            <div class="about-modal-header">
                <span>关于 JiBaJiBa 播放器</span>
                <button class="about-modal-close" id="aboutModalClose">&times;</button>
            </div>
            <div class="about-modal-body">
                <div class="about-logo-large">
                    <svg viewBox="0 0 512 512"><path fill="currentColor" d="M96.7 270.3C49 360.7 10 435 10 435.3c0 .4 16.5.6 36.6.5l36.6-.3 50-94.5c27.5-52 51.5-97.4 53.4-101l3.5-6.5-.4 89.5-.4 89.5 15.8 11.8 15.8 11.7h192.4l15.8-11.7 15.8-11.8.1-147c0-88.9-.4-146.5-.9-146-.5.6-15.6 26.2-33.6 57l-32.6 55.9.1 58.8V350H257V106h-73.5z"/><path fill="maroon" d="M370.3 107.2c-.5.7-24.2 41.4-52.7 90.5l-51.7 89.1-.2 26.6-.2 26.6 21.7-.2 21.7-.3 67.4-116 67.4-116-15.6-.6c-29.6-1.2-56.8-1-57.8.3"/></svg>
                </div>
                <div class="about-info">
                    <p><strong>版本：</strong>v4.3.8</p>
                    <p><strong>技术栈：</strong>WebRTC / WHEP</p>
                    <p><strong>功能特性：</strong></p>
                    <ul>
                        <li>支持 WebRTC 低延迟直播</li>
                        <li>分屏多流同时观看</li>
                        <li>自动重连与 ICE 恢复</li>
                        <li>实时音视频质量监控</li>
                        <li>音频可视化显示</li>
                        <li>深色/浅色主题切换</li>
                    </ul>
                    <p class="about-copyright">© 2024 JiBaJiBa Player</p>
                </div>
            </div>
        </div>
    </div>

    <script src="../assets/js/theme-manager.js?v=4.3.3"></script>
    <script src="adapter.js?v=4.3.3"></script>
    <script src="js/stream-status.js?v=4.3.6"></script>
    <script src="js/jiBaJiBa.js?v=4.3.9"></script>
</body>
</html>